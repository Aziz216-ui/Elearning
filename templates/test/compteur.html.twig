{% extends 'base.html.twig' %}

{% block title %}Test Compteur Quiz{% endblock %}

{% block body %}
<div class="container mt-5">
    <h1>Test des Compteurs de Quiz</h1>
    
    {# Compteur de progression #}
    <div class="card mb-3">
        <div class="card-header">
            <h3>Compteur de Progression</h3>
        </div>
        <div class="card-body">
            <div class="progress">
                <div class="progress-bar" role="progressbar" 
                     style="width: {{ (quiz.currentQuestion / quiz.totalQuestions * 100) }}%">
                    {{ quiz.currentQuestion }} / {{ quiz.totalQuestions }}
                </div>
            </div>
            <p class="mt-2">Question {{ quiz.currentQuestion }} sur {{ quiz.totalQuestions }}</p>
        </div>
    </div>

    {# Compteur de score #}
    <div class="card mb-3">
        <div class="card-header">
            <h3>Compteur de Score</h3>
        </div>
        <div class="card-body">
            <h2>{{ quiz.correctAnswers }} / {{ quiz.currentQuestion }}</h2>
            <p>Réponses correctes</p>
        </div>
    </div>

    {# Compteur de temps #}
    <div class="card mb-3">
        <div class="card-header">
            <h3>Compteur de Temps</h3>
        </div>
        <div class="card-body">
            <h2 id="timer">{{ (quiz.timeRemaining / 60)|number_format(0) }}:{{ "%02d"|format(quiz.timeRemaining % 60) }}</h2>
            <button id="start-timer" class="btn btn-primary">Démarrer le chronomètre</button>
        </div>
    </div>
</div>

<script>
    let timeRemaining = {{ quiz.timeRemaining }};
    let timerInterval;

    document.getElementById('start-timer').addEventListener('click', function() {
        this.disabled = true;
        
        timerInterval = setInterval(() => {
            timeRemaining--;
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timer').textContent = 
                `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (timeRemaining <= 0) {
                clearInterval(timerInterval);
                alert('Temps écoulé !');
            }
        }, 1000);
    });
</script>
{% endblock %}
